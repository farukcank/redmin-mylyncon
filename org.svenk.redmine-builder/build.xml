<?xml version="1.0" encoding="UTF-8"?>
<project name="Redmine-Mylyn Build" default="main">
    <description>
            description
    </description>

	<target name="build" description="Call the Equinox Laucher">
		<property name="buildResultsDirectory" value="${buildDirectory}/results" />
		
		<java classname="org.eclipse.equinox.launcher.Main" fork="true" 
			failonerror="true" errorproperty="build.stderr">
			<arg value="-application" />
			<arg value="org.eclipse.ant.core.antRunner" />
			<arg value="-buildfile" />
			<arg value="${buildfile}" />
			<arg value="${buildTarget}" />
			<jvmarg value="-Dbuilder=${buildHome}/build-files" />
			<jvmarg value="-DjavacFailOnError=true"/>
			<jvmarg value="-DbuildDirectory=${buildDirectory}"/>
			<!--
			<jvmarg value="-DbuildResultsDirectory=${buildResultsDirectory}"/>
			-->
			<jvmarg value="-DbaseLocation=${eclipseDir}"/>
			<jvmarg value="-DbuildHome=${buildHome}"/>
			<!--
			<jvmarg value="-Dversion.full=${version.full}"/>
			<jvmarg value="-Dversion.qualifier=${version.qualifier}${buildTypePresentation}"/>
			-->
			<!--
			<jvmarg value="-DfetchTag=${fetchTag}"/>
			-->
			<jvmarg value="-DbuildProperties=${buildHome}/build-files/build.properties"/>

			<classpath>
				<pathelement location="${equinoxjar}" />
			</classpath>
			
			<!--
			<syspropertyset>
				<propertyset>
					<propertyref prefix="buildSystemProperty"/>
					<mapper type="glob" from="buildSystemProperty.*" to="*"/>
				</propertyset>
			</syspropertyset>
			-->
		</java>
		
		<!-- save stderr for scrutinizing later -->
		<!--
		<echo file="${buildDirectory}/stderr.txt">${build.stderr}</echo>
		
		<echo taskname="stderr">${build.stderr}</echo>
		
		<condition property="is.build.error" value="true">
			<contains string="${build.stderr}" substring="BUILD FAILED"/>
		</condition>
		-->
		<!-- Note that the fail task throws an exception which will be intercepted
		     from calling antcalls. During that processing the status will 
		     be lost and set to 1. Therefor ethe processing of TESTS FAILED which should 
		     return an exit status of 2 can only take place in main targets. -->
		<!--
		<fail message="PDE Build failed" if="is.build.error" status="1"/>
		-->

	</target>
	
    <target name="main" description="Run the ...">
        <antcall target="build"></antcall>
    </target>


</project>
